library(tidyverse) # used for data manipulation
library(rmarkdown) # used for paged_table function
library(wakefield)#to generate vector of random names
library(ggrepel)
library(EnhancedVolcano)#volcanoPlot package
Gene <- name(300)
Log2FC <- runif(300, min=-5, max=5)
p.adj <- runif(300, min=0, max=0.9)
DF_Input_C1 <- data.frame(Gene, Log2FC, p.adj, stringsAsFactors=FALSE)
Log2FC <- runif(300, min=-2, max=9)
p.adj <- runif(300, min=0, max=0.7)
DF_Input_C2 <- data.frame(Gene, Log2FC, p.adj, stringsAsFactors=FALSE)
VolcanoPlot_Multiple(InputData_1=DF_Input_C1,
Condition_1="60min_versus_0min",
InputData_2=DF_Input_C2,
Condition2="120min_versus_0min",
Omics="Gene",
OutputPlotName="Proteomics_01.06.2020")
VolcanoPlot_Multiple <- function(InputData_1, Condition_1, InputData_2, Condition2, Omics, OutputPlotName){
#1. Include a column naming the set:
InputData_1[,"comparison"]  <- as.character("InputData1")
InputData_2[,"comparison"]  <- as.character("InputData2")
#2. Add the colour:
InputData_1[,"colour"]  <- as.character("#440154FF")
InputData_2[,"colour"]  <- as.character("#404788FF")
#3. Combine the files
Combined <- rbind(InputData_1,InputData_2)
#4.Prepare new colour scheme
keyvals <- ifelse(
Combined$colour == "#440154FF", "#440154FF",
ifelse(Combined$colour == "#404788FF", "#404788FF",
"black"))
keyvals[is.na(keyvals)] <- 'black'
names(keyvals)[keyvals == '#440154FF'] <- paste(Condition_1)
names(keyvals)[keyvals == '#404788FF'] <- paste(Condition2)
names(keyvals)[keyvals == 'black'] <- 'X'
#5. Make the Plot
VolcanoPlot <- EnhancedVolcano (Combined,
lab = paste("Combined$", Omics),
x = "Log2FC",#Log2FC
y = "p.adj",#p-value or q-value
xlab = bquote(~Log[2]~ "FC"),
ylab = bquote(~-Log[10]~p.adj),#(~-Log[10]~adjusted~italic(P))
pCutoff = 0.05,
FCcutoff = 0.5,#Cut off Log2FC, automatically 2
pointSize = 3,
labSize = 1.5,
colCustom = keyvals,
titleLabSize = 16,
colAlpha = 0.5,
title=paste(OutputPlotName),
subtitle = paste(Omics, ": Comparison of two conditions"),
caption = paste0("total = ", (nrow(Combined)/2)," ", Omics),
xlim = c((((Reduce(min,Combined$Log2FC))))-0.5,(((Reduce(max,Combined$Log2FC))))+0.5),
ylim = c(0,(ceiling(-log10(Reduce(min,Combined$p.adj))))),
#drawConnectors = TRUE,
#widthConnectors = 0.5,
#colConnectors = "black",
cutoffLineType = "dashed",
cutoffLineCol = "black",
cutoffLineWidth = 0.5,
legendLabels=c('No changes',"-0.5< Log2FC <0.5", 'p.adj<0.05 & -0.5< Log2FC <0.5"'),
legendPosition = 'right',
legendLabSize = 12,
legendIconSize = 5.0,
gridlines.major = FALSE,
gridlines.minor = FALSE,
)
ggsave(file=paste("Output_Figures/VolcanoPlot_Multiple", OutputPlotName, ".pdf", sep="_"), plot=VolcanoPlot, width=10, height=8)
plot(VolcanoPlot)
}
VolcanoPlot_Multiple(InputData_1=DF_Input_C1,
Condition_1="60min_versus_0min",
InputData_2=DF_Input_C2,
Condition2="120min_versus_0min",
Omics="Gene",
OutputPlotName="Proteomics_01.06.2020")
VolcanoPlot_Multiple <- function(InputData_1, Condition_1, InputData_2, Condition2, OutputPlotName){
#1. Include a column naming the set:
InputData_1[,"comparison"]  <- as.character("InputData1")
InputData_2[,"comparison"]  <- as.character("InputData2")
#2. Add the colour:
InputData_1[,"colour"]  <- as.character("#440154FF")
InputData_2[,"colour"]  <- as.character("#404788FF")
#3. Combine the files
Combined <- rbind(InputData_1,InputData_2)
#4.Prepare new colour scheme
keyvals <- ifelse(
Combined$colour == "#440154FF", "#440154FF",
ifelse(Combined$colour == "#404788FF", "#404788FF",
"black"))
keyvals[is.na(keyvals)] <- 'black'
names(keyvals)[keyvals == '#440154FF'] <- paste(Condition_1)
names(keyvals)[keyvals == '#404788FF'] <- paste(Condition2)
names(keyvals)[keyvals == 'black'] <- 'X'
#5. Make the Plot
VolcanoPlot <- EnhancedVolcano (Combined,
lab = Combined$Gene,
x = "Log2FC",#Log2FC
y = "p.adj",#p-value or q-value
xlab = bquote(~Log[2]~ "FC"),
ylab = bquote(~-Log[10]~p.adj),#(~-Log[10]~adjusted~italic(P))
pCutoff = 0.05,
FCcutoff = 0.5,#Cut off Log2FC, automatically 2
pointSize = 3,
labSize = 1.5,
colCustom = keyvals,
titleLabSize = 16,
colAlpha = 0.5,
title=paste(OutputPlotName),
subtitle = paste(Omics, ": Comparison of two conditions"),
caption = paste0("total = ", (nrow(Combined)/2),"Genes"),
xlim = c((((Reduce(min,Combined$Log2FC))))-0.5,(((Reduce(max,Combined$Log2FC))))+0.5),
ylim = c(0,(ceiling(-log10(Reduce(min,Combined$p.adj))))),
#drawConnectors = TRUE,
#widthConnectors = 0.5,
#colConnectors = "black",
cutoffLineType = "dashed",
cutoffLineCol = "black",
cutoffLineWidth = 0.5,
legendLabels=c('No changes',"-0.5< Log2FC <0.5", 'p.adj<0.05 & -0.5< Log2FC <0.5"'),
legendPosition = 'right',
legendLabSize = 12,
legendIconSize = 5.0,
gridlines.major = FALSE,
gridlines.minor = FALSE,
)
ggsave(file=paste("Output_Figures/VolcanoPlot_Multiple", OutputPlotName, ".pdf", sep="_"), plot=VolcanoPlot, width=10, height=8)
plot(VolcanoPlot)
}
VolcanoPlot_Multiple(InputData_1=DF_Input_C1,
Condition_1="60min_versus_0min",
InputData_2=DF_Input_C2,
Condition2="120min_versus_0min",
OutputPlotName="Proteomics_01.06.2020")
VolcanoPlot_Multiple <- function(InputData_1, Condition_1, InputData_2, Condition2, OutputPlotName){
#1. Include a column naming the set:
InputData_1[,"comparison"]  <- as.character("InputData1")
InputData_2[,"comparison"]  <- as.character("InputData2")
#2. Add the colour:
InputData_1[,"colour"]  <- as.character("#440154FF")
InputData_2[,"colour"]  <- as.character("#404788FF")
#3. Combine the files
Combined <- rbind(InputData_1,InputData_2)
#4.Prepare new colour scheme
keyvals <- ifelse(
Combined$colour == "#440154FF", "#440154FF",
ifelse(Combined$colour == "#404788FF", "#404788FF",
"black"))
keyvals[is.na(keyvals)] <- 'black'
names(keyvals)[keyvals == '#440154FF'] <- paste(Condition_1)
names(keyvals)[keyvals == '#404788FF'] <- paste(Condition2)
names(keyvals)[keyvals == 'black'] <- 'X'
#5. Make the Plot
VolcanoPlot <- EnhancedVolcano (Combined,
lab = Combined$Gene,
x = "Log2FC",#Log2FC
y = "p.adj",#p-value or q-value
xlab = bquote(~Log[2]~ "FC"),
ylab = bquote(~-Log[10]~p.adj),#(~-Log[10]~adjusted~italic(P))
pCutoff = 0.05,
FCcutoff = 0.5,#Cut off Log2FC, automatically 2
pointSize = 3,
labSize = 1.5,
colCustom = keyvals,
titleLabSize = 16,
colAlpha = 0.5,
title=paste(OutputPlotName),
subtitle = paste("Comparison of two conditions"),
caption = paste0("total = ", (nrow(Combined)/2),"Genes"),
xlim = c((((Reduce(min,Combined$Log2FC))))-0.5,(((Reduce(max,Combined$Log2FC))))+0.5),
ylim = c(0,(ceiling(-log10(Reduce(min,Combined$p.adj))))),
#drawConnectors = TRUE,
#widthConnectors = 0.5,
#colConnectors = "black",
cutoffLineType = "dashed",
cutoffLineCol = "black",
cutoffLineWidth = 0.5,
legendLabels=c('No changes',"-0.5< Log2FC <0.5", 'p.adj<0.05 & -0.5< Log2FC <0.5"'),
legendPosition = 'right',
legendLabSize = 12,
legendIconSize = 5.0,
gridlines.major = FALSE,
gridlines.minor = FALSE,
)
ggsave(file=paste("Output_Figures/VolcanoPlot_Multiple", OutputPlotName, ".pdf", sep="_"), plot=VolcanoPlot, width=10, height=8)
plot(VolcanoPlot)
}
VolcanoPlot_Multiple(InputData_1=DF_Input_C1,
Condition_1="60min_versus_0min",
InputData_2=DF_Input_C2,
Condition2="120min_versus_0min",
OutputPlotName="Proteomics_01.06.2020")
