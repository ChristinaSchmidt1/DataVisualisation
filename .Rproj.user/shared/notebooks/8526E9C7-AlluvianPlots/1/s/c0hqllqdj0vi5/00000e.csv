"0",""
"0","#------------------------------"
"0","# Make an example DF:"
"0","## For example condition one is KO versus WT from cell cultured in Hypoxia"
"0","Gene <- name(50)"
"0","Log2FC <- runif(50, min=-5, max=5)"
"0","p.adj <- runif(50, min=0, max=0.2)"
"0","DF_Input_C1 <- data.frame(Gene, Log2FC, p.adj, stringsAsFactors=FALSE)"
"0","DF_Input_C1$Condition <- ""Hypoxia"""
"0",""
"0","## And condition two is KO versus WT from cell cultured in Normoxia"
"0","Log2FC <- runif(50, min=-2, max=9)"
"0","p.adj <- runif(50, min=0, max=0.1)"
"0","DF_Input_C2 <- data.frame(Gene, Log2FC, p.adj, stringsAsFactors=FALSE)"
"0","DF_Input_C2$Condition <- ""Normoxia"""
"0",""
"0","## Combine the DF and add parameters for e.g. thresholds you apply to extract genes:"
"0","DF_Iput <-rbind(DF_Input_C1,DF_Input_C2)%>%"
"0","  mutate(`Change` = case_when(Log2FC > 0.5  ~ 'UP',"
"0","                                 Log2FC < -0.5 ~ 'DOWN',"
"0","                                  TRUE ~ 'No Change')) %>%"
"0","  mutate(`Significant` = case_when(p.adj <= 0.05  ~ 'YES',"
"0","                                  p.adj > 0.05 ~ 'NO',"
"0","                                  TRUE ~ 'FALSE')) %>%"
"0","  mutate(`Significant Change` = case_when(Log2FC > 0.5 & p.adj <= 0.05  ~ 'UP',"
"0","                                  Log2FC < -0.5 & p.adj <= 0.05 ~ 'DOWN',"
"0","                                  TRUE ~ 'No Change'))"
"0","DF_Iput$Frequency <-1"
"0","#---------------------------"
"0","#Plot"
"0","pdf(""Output_Figures/AlluvianPlot_Method_Overview.pdf"")# Open a pdf file , paper=""a4r"" --> landscape A4"
"0","par(oma=c(2,2,8,2), mar = c(2, 2, 0.1, 2)+0.1)#https://www.r-graph-gallery.com/74-margin-and-oma-cheatsheet.html"
"0",""
"0","alluvial(DF_Iput[,c(4:7,1)], freq=DF_Iput$Frequency,"
"0","         col = case_when(DF_Iput$Condition == ""Hypoxia""  ~ 'blue',"
"0","                         DF_Iput$Condition == ""Normoxia"" ~ 'red',"
"0","                         TRUE ~ 'grey'),"
"0","         border = case_when(DF_Iput$Condition == ""Hypoxia""  ~ 'blue',"
"0","                         DF_Iput$Condition == ""Normoxia"" ~ 'red',"
"0","                         TRUE ~ 'grey'),"
"0","         hide = DF_Iput$Frequency == 0,"
"0","         cex = 0.3,"
"0","         cex.axis = 0.5)"
